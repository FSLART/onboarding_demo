name: Auto Label Issues

on:
  issues:
    types: [opened]

jobs:
  auto-label:
    runs-on: ubuntu-latest
    steps:
      - name: Auto label issue based on content
        uses: actions/github-script@v6
        with:
          script: |
            const title = context.payload.issue.title || "";
            const body = context.payload.issue.body || "";
            const text = `${title}\n${body}`.toLowerCase();
            let labels = [];
            if (text.includes("bug")) {
              labels.push("bug");
            }
            if (text.includes("docs") || text.includes("documentation")) {
              labels.push("documentation");
            }
            if (text.includes("feature") || text.includes("enhancement")) {
              labels.push("enhancement");
            }
            if (text.includes("?") || text.includes("how") || text.includes("why")) {
              labels.push("question");
            }
            if (labels.length === 0) {
              labels = ["needs-triage"];
            }
            await github.rest.issues.addLabels({
              owner: context.repo.owner,
              repo: context.repo.repo,
              issue_number: context.issue.number,
              labels: labels,
            });